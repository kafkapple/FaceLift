profile: false
debug: false
model:
  class_name: gslrm.model.gslrm.GSLRM
  image_tokenizer:
    image_size: 512
    patch_size: 8
    in_channels: 9
  transformer:
    d: 1024
    d_head: 64
    n_layer: 24
  gaussians:
    n_gaussians: 2
    sh_degree: 0
    upsampler:
      upsample_factor: 1
  add_refsrc_marker: false
  hard_pixelalign: true
  use_custom_plucker: true
  clip_xyz: true
training:
  runtime:
    use_tf32: true
    use_amp: true
    amp_dtype: bf16
    torch_compile: false
    grad_accum_steps: 2
    grad_clip_norm: 100.0
    grad_checkpoint_every: 1
  dataset:
    dataset_path: data_mouse_pixel_based/data_mouse_train.txt
    maximize_view_overlap: false
    num_views: 6
    num_input_views: 5
    target_has_input: true
    normalize_distance_to: 0.0
    remove_alpha: false
    background_color: white
  dataloader:
    batch_size_per_gpu: 2
    num_workers: 4
    num_threads: 16
    prefetch_factor: 8
  losses:
    l2_loss_weight: 1.0
    lpips_loss_weight: 0.0
    perceptual_loss_weight: 0.0
    ssim_loss_weight: 0.5
    pixelalign_loss_weight: 0.0
    masked_pixelalign_loss: true
    masked_l2_loss: true
    masked_ssim_loss: true
    background_loss_weight: 0.1
    pointsdist_loss_weight: 0.0
    warmup_pointsdist: false
    distill_loss_weight: 0.0
    clamp_rendering: true
  optimizer:
    lr: 1.0e-06
    beta1: 0.9
    beta2: 0.95
    weight_decay: 0.05
    reset_lr: true
    reset_weight_decay: false
    reset_training_state: true
  schedule:
    num_epochs: 50000
    early_stop_after_epochs: 50000
    max_fwdbwd_passes: 10000
    warmup: 200
    l2_warmup_steps: 200
  checkpointing:
    checkpoint_dir: checkpoints/gslrm/mouse_pixel_based_v2
    checkpoint_every: 200
    resume_ckpt: checkpoints/gslrm/ckpt_0000000000021125.pt
  logging:
    print_every: 5
    vis_every: 50
    wandb:
      project: mouse_facelift
      group: gslrm
      job_type: finetune_pixel_based_v2
      exp_name: mouse_gslrm_pixel_based_v2_masked
      log_every: 5
      offline: false
mouse:
  augmentation:
    enabled: true
    brightness_range:
    - 0.9
    - 1.1
    contrast_range:
    - 0.9
    - 1.1
    hflip: false
  use_mouse_dataset: true
  normalize_cameras: true
  target_camera_distance: 2.7
  normalize_to_z_up: true
  auto_generate_mask: false
  mask_threshold: 250
validation:
  enabled: true
  dataset_path: data_mouse_pixel_based/data_mouse_val.txt
  output_dir: experiments/validation/mouse_gslrm_pixel_based_v2
  val_every: 100
inference:
  enabled: false
  output_dir: experiments/inference/mouse_gslrm_pixel_based_v2
