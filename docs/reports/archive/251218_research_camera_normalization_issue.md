---
date: 2024-12-18
context_name: "2_Research"
tags: [ai-assisted, mouse-facelift, gs-lrm, camera-normalization, coordinate-system]
project: mouse-facelift
status: in-progress
generator: ai-assisted
generator_tool: claude-code
---

# GS-LRM ì¹´ë©”ë¼ ì •ê·œí™” ì´ìŠˆ ë¶„ì„ ë° í•´ê²°

## 1. ë¬¸ì œ ìš”ì•½

### 1.1 í˜„ìƒ
- GS-LRM fine-tuning ì‹œ ì¶œë ¥ì´ **íë¦¿í•˜ê²Œ(blurry)** ìƒì„±ë¨
- Mode collapse ë˜ëŠ” mean regression í˜„ìƒ ì˜ì‹¬

### 1.2 í•µì‹¬ ë°œê²¬
**ì¸ê°„ ë°ì´í„° ìƒ˜í”Œ ë¶„ì„ ê²°ê³¼, GS-LRM pretrained ëª¨ë¸ì€ Z-up ì¢Œí‘œê³„ë¥¼ ì‚¬ìš©!**

```
ì¸ê°„ ë°ì´í„° (data_sample/gslrm/sample_000):
- Up Vector: [0, 0, 1] â†’ Z-up!
- Y-component: 0.000

ìƒì¥ ë°ì´í„° (ì •ê·œí™” ì ìš© í›„):
- Up Vector: [0, 0.015, 1] â†’ ê±°ì˜ Z-up
- Y-component: 0.015 (Y-up ì •ê·œí™”ê°€ ì ìš©ë˜ì§€ ì•Šì€ ìƒíƒœ)
```

**â†’ í˜„ì¬ `mouse_dataset.py`ì˜ `normalize_cameras_to_y_up()`ì´ Y-upìœ¼ë¡œ ë³€í™˜í•˜ë ¤ê³  í•˜ì§€ë§Œ, ì¸ê°„ ë°ì´í„°ê°€ Z-upì´ë¯€ë¡œ ì˜¤íˆë ¤ ì—­íš¨ê³¼!**

---

## 2. ì •ëŸ‰ì  ë¹„êµ ê²°ê³¼

### 2.1 ìŠ¤í™ ë¹„êµí‘œ

| í•­ëª© | ì¸ê°„ ë°ì´í„° | ìƒì¥ ë°ì´í„° | ìƒíƒœ |
|------|------------|------------|------|
| **ì´ë¯¸ì§€ í¬ê¸°** | 512Ã—512 | 512Ã—512 | âœ… MATCH |
| **Focal Length** | 548.99 | 548.99 | âœ… MATCH |
| **ì¹´ë©”ë¼ ê±°ë¦¬** | 2.700 Â± 0.000 | 2.700 Â± 0.422 | âš ï¸ ë¶„ì‚° ì°¨ì´ |
| **Up ë°©í–¥** | Z-up [0,0,1] | ~Z-up [0,0.015,1] | âš ï¸ ë¶ˆì¼ì¹˜ |
| **Elevation ë²”ìœ„** | -70Â° ~ +70Â° | -51Â° ~ +78Â° | âš ï¸ ë¶„í¬ ì°¨ì´ |
| **ë·° ê°œìˆ˜** | 32 | 6 | ì˜ë„ëœ ì°¨ì´ |

### 2.2 ì¹´ë©”ë¼ Up Vector ë¹„êµ

| ë°ì´í„°ì…‹ | í‰ê·  Up Vector | Y ì„±ë¶„ | ì¢Œí‘œê³„ |
|----------|----------------|--------|--------|
| ì¸ê°„ | `[-2.4e-9, 1.1e-9, 1.0]` | 0.000 | **Z-up** |
| ìƒì¥ | `[-0.006, 0.015, 1.0]` | 0.015 | **~Z-up** |

### 2.3 Orbit Plane ë¶„ì„

| ë°ì´í„°ì…‹ | Planarity | Orbit Normal | í•´ì„ |
|----------|-----------|--------------|------|
| ì¸ê°„ | 1.0000 | `[0, 0, 1]` | ì™„ë²½í•œ XY í‰ë©´ orbit |
| ìƒì¥ | 0.9654 | `[-0.012, 0.006, 1.0]` | ê±°ì˜ XY í‰ë©´ |

---

## 3. ì›ì¸ ë¶„ì„ (3ê°€ì§€)

### Issue 1: Up Direction ì •ê·œí™” ë°©í–¥ ì˜¤ë¥˜ ğŸ”´

**í˜„ì¬ ì½”ë“œ (`mouse_dataset.py:122`):**
```python
target_up = np.array([0.0, 1.0, 0.0])  # Y-up
```

**ì¸ê°„ ë°ì´í„° ì‹¤ì œ ê°’:**
```python
# Z-up! (Y-upì´ ì•„ë‹˜)
avg_up = [0, 0, 1]
```

**ë¬¸ì œ**: Y-upìœ¼ë¡œ ì •ê·œí™”í•˜ë©´ ì¸ê°„ ë°ì´í„°ì™€ ë¶ˆì¼ì¹˜

### Issue 2: ì¹´ë©”ë¼ ê±°ë¦¬ ë¶„ì‚° ì°¨ì´ ğŸŸ¡

| | ì¸ê°„ | ìƒì¥ |
|---|------|------|
| Mean | 2.700 | 2.700 |
| Std | 0.000 | 0.422 |
| Range | [2.7, 2.7] | [2.0, 3.4] |

**ë¬¸ì œ**: ì¸ê°„ ë°ì´í„°ëŠ” ëª¨ë“  ì¹´ë©”ë¼ê°€ ì •í™•íˆ 2.7 ê±°ë¦¬, ìƒì¥ëŠ” ë¶„ì‚° ìˆìŒ
**ì›ì¸**: `normalize_camera_distance()`ê°€ **ê° ì¹´ë©”ë¼ë¥¼ ê°œë³„ì ìœ¼ë¡œ** 2.7ë¡œ ì •ê·œí™”í•˜ì§€ ì•Šê³ , ì „ì²´ ìŠ¤ì¼€ì¼ë§Œ ì¡°ì •

### Issue 3: Elevation ë¶„í¬ ì°¨ì´ ğŸŸ¡

**ì¸ê°„ ë°ì´í„°**: êµ¬í˜• ë¶„í¬ (32ë·°, -70Â° ~ +70Â°)
**ìƒì¥ ë°ì´í„°**: ë¶ˆê· ì¼ ë¶„í¬ (6ë·°, -51Â° ~ +78Â°)

**ì˜í–¥**: ëª¨ë¸ì´ ë‹¤ì–‘í•œ elevationì—ì„œ í•™ìŠµë˜ì–´ì•¼ í•˜ì§€ë§Œ, ìƒì¥ ë°ì´í„°ëŠ” ì œí•œì 

---

## 4. ìˆ˜ì • ê³„íš

### Option A: Z-up ì •ê·œí™”ë¡œ ë³€ê²½ (ê¶Œì¥)

**ìˆ˜ì • ë‚´ìš©:**
1. `normalize_cameras_to_y_up()` â†’ `normalize_cameras_to_z_up()`ë¡œ ë³€ê²½
2. `target_up = [0, 0, 1]` ì‚¬ìš©
3. configì—ì„œ `normalize_to_z_up: true` ì˜µì…˜ ì¶”ê°€

**ì¥ì :**
- ì¸ê°„ ë°ì´í„°ì™€ ì™„ë²½ ì¼ì¹˜
- pretrained ëª¨ë¸ ê¸°ëŒ€ í˜•ì‹ê³¼ ë™ì¼

### Option B: ì •ê·œí™” ë¹„í™œì„±í™”

**ìˆ˜ì • ë‚´ìš©:**
1. `normalize_cameras: false` ì„¤ì •
2. ì›ë³¸ ì¹´ë©”ë¼ íŒŒë¼ë¯¸í„° ê·¸ëŒ€ë¡œ ì‚¬ìš©

**ì¥ì :**
- ê°€ì¥ ê°„ë‹¨í•œ ìˆ˜ì •
- ì›ë³¸ ë°ì´í„° ì •ë³´ ë³´ì¡´

**ë‹¨ì :**
- ì¸ê°„ ë°ì´í„°ì™€ ì¢Œí‘œê³„ ë¶ˆì¼ì¹˜ ê°€ëŠ¥ì„±

### Option C: ì¹´ë©”ë¼ ê±°ë¦¬ ê· ì¼í™” ê°•í™”

**ìˆ˜ì • ë‚´ìš©:**
1. ê±°ë¦¬ ì •ê·œí™”ë¥¼ **ê°œë³„ ì¹´ë©”ë¼** ë‹¨ìœ„ë¡œ ì ìš©
2. ëª¨ë“  ì¹´ë©”ë¼ê°€ ì •í™•íˆ 2.7 ê±°ë¦¬ë¥¼ ê°–ë„ë¡

**ì½”ë“œ:**
```python
def normalize_camera_distance_strict(c2w_matrices, target=2.7):
    for c2w in c2w_matrices:
        pos = c2w[:3, 3]
        dist = np.linalg.norm(pos)
        c2w[:3, 3] = pos * (target / dist)  # ì •í™•íˆ 2.7ë¡œ
    return c2w_matrices
```

---

## 5. êµ¬í˜„ ê²°ì •

### ì„ íƒ: Option A + Option C

1. **Z-up ì •ê·œí™”**: ì¸ê°„ ë°ì´í„°ì™€ ë™ì¼í•œ ì¢Œí‘œê³„
2. **ì—„ê²©í•œ ê±°ë¦¬ ì •ê·œí™”**: ëª¨ë“  ì¹´ë©”ë¼ ì •í™•íˆ 2.7
3. **ìƒˆ config íŒŒì¼**: `mouse_gslrm_zup.yaml`

---

## 6. ê´€ë ¨ íŒŒì¼

| íŒŒì¼ | ì—­í•  |
|------|------|
| `gslrm/data/mouse_dataset.py` | ì¹´ë©”ë¼ ì •ê·œí™” í•¨ìˆ˜ |
| `configs/mouse_gslrm_v2.yaml` | í˜„ì¬ í•™ìŠµ ì„¤ì • |
| `scripts/compare_human_mouse_camera_specs.py` | ë¹„êµ ìŠ¤í¬ë¦½íŠ¸ |
| `docs/reports/251218_camera_spec_comparison_report.md` | ë¹„êµ ê²°ê³¼ ë³´ê³ ì„œ |

---

## 7. pose-splatter ì°¸ê³ 

**`render_32views_for_facelift.py`ì˜ ì¢Œí‘œê³„ ì²˜ë¦¬:**

```python
# Line 457: target_up = [0, -1, 0] (Y-down, OpenCV convention)
target_up = np.array([0.0, -1.0, 0.0])

# ì‹¤ì œë¡œëŠ” ì¹´ë©”ë¼ up vector (image ê¸°ì¤€ ìœ„)ê°€ world -Y ë°©í–¥
# ì´ëŠ” OpenCV camera conventionê³¼ ì¼ì¹˜
```

**í•µì‹¬ ì°¨ì´:**
- pose-splatter: ì¹´ë©”ë¼ì˜ "up" ë°©í–¥ì„ world -Yë¡œ ì •ë ¬
- mouse_dataset: ì „ì²´ ì¢Œí‘œê³„ì˜ "up"ì„ Y-upìœ¼ë¡œ ì •ë ¬

ë‘ ì ‘ê·¼ë²•ì€ ë‹¤ë¥¸ ëª©ì :
- pose-splatter: ë Œë”ë§ ì‹œ ì¼ê´€ëœ image orientation
- mouse_dataset: 3D ê³µê°„ì—ì„œ ì¼ê´€ëœ ì¢Œí‘œê³„

---

## 8. ë‹¤ìŒ ë‹¨ê³„

1. [ ] `mouse_dataset.py` ìˆ˜ì •: Z-up ì •ê·œí™” + ì—„ê²©í•œ ê±°ë¦¬ ì •ê·œí™”
2. [ ] ìƒˆ config ìƒì„±: `mouse_gslrm_zup.yaml`
3. [ ] ìˆ˜ì •ëœ ì½”ë“œë¡œ í•™ìŠµ ì‹¤í–‰
4. [ ] ê²°ê³¼ ë¹„êµ (ê¸°ì¡´ vs ìˆ˜ì •)

---

*ğŸ¤– Generated with Claude Code*
